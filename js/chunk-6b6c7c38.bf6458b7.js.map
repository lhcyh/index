{"version":3,"sources":["webpack:///./src/views/favorites/Index.vue?2c50","webpack:///./src/utils/lhUtils.js","webpack:///./src/views/favorites/Index.vue","webpack:///./src/utils/file.js","webpack:///src/views/favorites/Index.vue","webpack:///./src/views/favorites/Index.vue?1b66","webpack:///./src/views/favorites/Index.vue?bb6c"],"names":["splitValueUnit","valueUnit","res","value","unit","parseFloat","replace","twoDigits","formatDate","date","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minute","getMinutes","second","getSeconds","render","_vm","this","_c","_self","staticClass","maxVersion","_v","attrs","on","clearFile","visible","$event","slot","selectFile","apkFile","staticStyle","_s","name","_e","versionString","model","version","callback","$$v","$set","expression","_l","vList","item","index","key","force","loading","confirm","eVisible","eVersion","update","save","versionList","id","updateTime","edit","deleteVersion","staticRenderFns","SaveUrl","DEFAULT","APK","uploadFile","file","saveUrl","remarks","p","Promise","resolve","reject","uploadFile2","then","data","catch","err","suffix","split","pop","axios","get","params","form","FormData","append","authorization","token","cos_file_id","post","url","fileInfo","file_id","filePojo","fileId","mounted","getMaxVersion","getVersionList","methods","that","request","push","partMap","p1","p2","p3","e","console","log","target","files","$lhMessage","finally","$lhLoading","open","close","updateVersion","$lhMessageBox","headers","splice","Date","component"],"mappings":"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","file":"js/chunk-6b6c7c38.bf6458b7.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&id=481433ae&prod&scoped=true&lang=less&\"","export const splitValueUnit=function(valueUnit){\r\n  let res={\r\n    value:null,\r\n    unit:null\r\n  }\r\n  res.value=parseFloat(valueUnit);\r\n  res.unit=valueUnit.replace(res.value,'').replace(/\\\\./, '');\r\n  return res;\r\n}\r\n\r\nconst twoDigits=function(value) {\r\n  return value < 10 ? '0' + value : value;\r\n}\r\n\r\n/**\r\n * 日期转化为字符串：yyyy-MM-dd HH:mm:ss\r\n * @param {*} date \r\n * @returns \r\n */\r\nexport const formatDate=function(date) {\r\n  let year = date.getFullYear();\r\n  let month = twoDigits(date.getMonth() + 1); // 月份是从0开始的\r\n  let day = twoDigits(date.getDate());\r\n  let hour = twoDigits(date.getHours());\r\n  let minute = twoDigits(date.getMinutes());\r\n  let second = twoDigits(date.getSeconds());\r\n  return `${year}-${month}-${day} ${hour}:${minute}:${second}`;\r\n}\r\n\r\n\r\n// export const HexToRGB=function(color){\r\n// \tlet newColor = 'rgba(';\r\n// \t//判断是四位还是八位\r\n// \tif(color.length === 5){\r\n// \t\tlet arry = [];\r\n// \t\tlet opacity=null;\r\n// \t\tfor(let i = 1;i < color.length;i++){\r\n// \t\t\tif(i===color.length-1){\r\n// \t\t\t\topacity=parseInt(\"0x\" + color[i] + color[i]);\r\n// \t\t\t\tbreak;\r\n// \t\t\t}\r\n// \t\t\tarry.push(parseInt(\"0x\" + color[i] + color[i]));\r\n// \t\t}\r\n// \t\tarry.forEach(function(item){\r\n// \t\t\tnewColor += item + ', ';\r\n// \t\t});\r\n// \t\tnewColor += opacity/255.0 + ')';\r\n// \t\treturn newColor;\r\n// \t}else{\r\n// \t\tlet arry = [];\r\n// \t\tlet opacity=null;\r\n// \t\tfor(let i = 1;i < color.length;i += 2){\r\n// \t\t\tif(i===color.length-2){\r\n// \t\t\t\topacity=parseInt(\"0x\" + color.slice(i,i+2));\r\n// \t\t\t\tbreak;\r\n// \t\t\t}\r\n// \t\t\tarry.push(parseInt(\"0x\" + color.slice(i,i+2)));\r\n// \t\t}\r\n \r\n// \t\tarry.forEach(function(item){\r\n// \t\t\tnewColor += item + ', ';\r\n// \t\t});\r\n// \t\tnewColor += opacity/255.0 + ')';\r\n// \t\treturn newColor;\r\n// \t}\r\n// }\r\n\r\n// export const checkRGBA=function(rgba){\r\n// \tlet str = rgba.slice(5,rgba.length - 1),\r\n// \tarry = str.split(','),\r\n// \tstatus = true,\r\n// \treg = /^rgba\\(\\d{1,3}(\\,\\s{0,1}\\d{1,3}){2}\\,\\s{0,1}(0|(0(\\.\\d{1,2}))|1)\\)$/;\r\n// \tarry.forEach(function(item,index){\r\n// \t\tif(index == arry.length - 1){\r\n// \t\t\tif(Number(item.trim()) < 0 || Number(item.trim()) > 1){\r\n// \t\t\t\tstatus = false;\r\n// \t\t\t}\r\n// \t\t}else{\r\n// \t\t\tif(Number(item.trim()) < 0 || Number(item.trim()) > 255){\r\n// \t\t\t\tstatus = false;\r\n// \t\t\t}\r\n// \t\t}\r\n// \t});\r\n\t\r\n// \tif(reg.test(rgba) && status){\r\n// \t\treturn true;\r\n// \t}else{\r\n// \t\treturn false;\r\n// \t}\r\n// }\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"favorites\"},[(_vm.maxVersion)?_c('div',{staticClass:\"content\"},[_c('h2',[_vm._v(\"版本管理\")]),_c('lh-button',{attrs:{\"icon\":\"lh-icon-delete\",\"backgroundColor\":\"red\"},on:{\"click\":_vm.clearFile}},[_vm._v(\"清除服务器失效文件\")]),_c('lh-dialog',{attrs:{\"visible\":_vm.visible},on:{\"update:visible\":function($event){_vm.visible=$event}}},[_c('div',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"添加版本\")]),_c('table',[_c('tr',[_c('td',[_vm._v(\"上传安装包\")]),_c('td',[_c('lh-button',{attrs:{\"accept\":\".apk\"},on:{\"change\":_vm.selectFile}},[_vm._v(\" 选择apk文件 \")]),(_vm.apkFile)?_c('div',{staticStyle:{\"font-size\":\"10px\",\"color\":\"red\"}},[_vm._v(\" \"+_vm._s(_vm.apkFile.name)+\" \")]):_vm._e()],1)]),_c('tr',[_c('td',[_vm._v(\" 设置版本号 \"),(_vm.maxVersion)?_c('div',{staticStyle:{\"font-size\":\"10px\",\"color\":\"red\"}},[_vm._v(\" *当前最大版本：\"+_vm._s(_vm.maxVersion.versionString)+\" \")]):_vm._e()]),_c('td',[_c('lh-select',{model:{value:(_vm.version.versionString),callback:function ($$v) {_vm.$set(_vm.version, \"versionString\", $$v)},expression:\"version.versionString\"}},_vm._l((_vm.vList),function(item,index){return _c('lh-option',{key:index,attrs:{\"value\":item}},[_vm._v(\" \"+_vm._s(item)+\" \")])}),1)],1)]),_c('tr',[_c('td',[_vm._v(\"是否强制更新\")]),_c('td',[_c('lh-radio',{attrs:{\"radioValue\":true},model:{value:(_vm.version.force),callback:function ($$v) {_vm.$set(_vm.version, \"force\", $$v)},expression:\"version.force\"}},[_vm._v(\"是\")]),_c('lh-radio',{attrs:{\"radioValue\":false},model:{value:(_vm.version.force),callback:function ($$v) {_vm.$set(_vm.version, \"force\", $$v)},expression:\"version.force\"}},[_vm._v(\"否\")])],1)])]),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('lh-button',{attrs:{\"loading\":_vm.loading},on:{\"click\":_vm.confirm}},[_vm._v(\"确认\")])],1)]),_c('lh-dialog',{attrs:{\"visible\":_vm.eVisible},on:{\"update:visible\":function($event){_vm.eVisible=$event}}},[_c('div',[_c('span',[_vm._v(\"是否强制更新：\")]),_c('lh-radio',{attrs:{\"radioValue\":true},model:{value:(_vm.eVersion.force),callback:function ($$v) {_vm.$set(_vm.eVersion, \"force\", $$v)},expression:\"eVersion.force\"}},[_vm._v(\"是\")]),_c('lh-radio',{attrs:{\"radioValue\":false},model:{value:(_vm.eVersion.force),callback:function ($$v) {_vm.$set(_vm.eVersion, \"force\", $$v)},expression:\"eVersion.force\"}},[_vm._v(\"否\")])],1),_c('lh-checkbox',{model:{value:(_vm.eVersion.update),callback:function ($$v) {_vm.$set(_vm.eVersion, \"update\", $$v)},expression:\"eVersion.update\"}},[_vm._v(\"设置为最新版本\")]),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('lh-button',{attrs:{\"loading\":_vm.loading},on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1),(_vm.maxVersion)?_c('lh-button',{on:{\"click\":function($event){_vm.visible=true}}},[_vm._v(\"添加新版本\")]):_vm._e(),_c('lh-table',[_c('lh-tr',[_c('lh-th',[_vm._v(\"序号\")]),_c('lh-th',[_vm._v(\"版本号\")]),_c('lh-th',[_vm._v(\"更新时间\")]),_c('lh-th',[_vm._v(\"是否强制更新\")]),_c('lh-th',[_vm._v(\"操作\")])],1),_vm._l((_vm.versionList),function(item,index){return _c('lh-tr',{key:item.id},[_c('lh-td',[_vm._v(_vm._s(index+1))]),_c('lh-td',[_vm._v(_vm._s(item.versionString))]),_c('lh-td',[_vm._v(\" \"+_vm._s(item.updateTime)+\" \"),(index==0)?_c('div',{staticStyle:{\"color\":\"red\",\"font-size\":\"10px\"}},[_vm._v(\"*最新版本\")]):_vm._e()]),_c('lh-td',[_vm._v(\" \"+_vm._s(item.force?\"是\":\"否\")+\" \")]),_c('lh-td',[_c('lh-button',{on:{\"click\":function($event){return _vm.edit(index)}}},[_vm._v(\"编辑\")]),_c('lh-button',{attrs:{\"icon\":\"lh-icon-delete\",\"backgroundColor\":\"red\"},on:{\"click\":function($event){return _vm.deleteVersion(index)}}},[_vm._v(\" 删除 \")])],1)],1)})],2)],1):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import axios from \"./request\";\r\n\r\nexport const SaveUrl={\r\n  DEFAULT:\"DEFAULT\",\r\n  APK:\"APK\"\r\n}\r\n\r\nexport const uploadFile=function(file,saveUrl,remarks){\r\n  let p=new Promise((resolve,reject)=>{\r\n    if(process.env.NODE_ENV==\"development\"){\r\n      uploadFile1(file,saveUrl,remarks).then((data)=>{\r\n        resolve(data);\r\n      }).catch((err)=>{\r\n        reject(err);\r\n      })\r\n    }else{\r\n      uploadFile2(file,saveUrl,remarks).then((data)=>{\r\n        resolve(data);\r\n      }).catch((err)=>{\r\n        reject(err);\r\n      })\r\n    }\r\n  });\r\n  return p;\r\n}\r\n\r\n/**\r\n * 上传文件，直接向后端上传文件，再由后端上传到对象存储，后端部署在微信云托管，由于微信云托管集群的nginx的限制，不能上传大文件\r\n * @param {*} file \r\n * @param {*} saveUrl \r\n * @param {*} remarks \r\n * @returns \r\n */\r\nconst uploadFile1=function(file,saveUrl,remarks){\r\n  let p=new Promise((resolve,reject)=>{\r\n    let formData=new FormData();\r\n    formData.append(\"file\",file);\r\n    formData.append(\"saveUrl\",saveUrl);\r\n    formData.append(\"remarks\",remarks);\r\n    axios.post(\"/file/uploadFile\",formData).then((res)=>{\r\n      resolve(res);\r\n    }).catch((err)=>{\r\n      reject(err);\r\n    });\r\n  });\r\n  return p;\r\n}\r\n\r\n/**\r\n * 上传文件，向微信云托管的对象存储上传文件，再把文件信息上传到后端\r\n * @param {*} file \r\n * @param {*} saveUrl \r\n * @param {*} remarks \r\n */\r\nconst uploadFile2=function(file,saveUrl,remarks){\r\n  let suffix=file.name.split(\".\").pop();\r\n  suffix=\".\"+suffix;\r\n  let p=new Promise((resolve,reject)=>{\r\n    /** 获取上传链接 */\r\n    axios.get(\"/file/getFileUploadUrl\",{\r\n      params:{\r\n        suffix:suffix,\r\n        saveUrl:saveUrl\r\n      }\r\n    }).then((data)=>{\r\n      //console.log(\"uploadData\",data);\r\n      let form=new FormData();\r\n      form.append(\"key\",data.key);\r\n      form.append(\"Signature\",data.authorization);\r\n      form.append(\"x-cos-security-token\",data.token);\r\n      form.append(\"x-cos-meta-fileid\",data.cos_file_id);\r\n      form.append(\"file\",file);\r\n      /** 向云托管的对象存储上传文件 */\r\n      axios.post(data.url,form).then(()=>{\r\n        let fileInfo={\r\n          key:data.key,\r\n          file_id:data.file_id,\r\n          remarks:remarks\r\n        }\r\n        /** 将文件信息上传到后端 */\r\n        axios.post(\"/file/addFile\",fileInfo).then((filePojo)=>{\r\n          resolve(filePojo);\r\n        }).catch((err)=>{\r\n          reject(err);\r\n        });\r\n      }).catch((err)=>{\r\n        reject(err);\r\n      });\r\n    }).catch((err)=>{\r\n      reject(err);\r\n    })\r\n  })\r\n  return p;\r\n}","<template>\r\n<div class=\"favorites\">\r\n  <div class=\"content\" v-if=\"maxVersion\">\r\n    <h2>版本管理</h2>\r\n    <lh-button @click=\"clearFile\" icon=\"lh-icon-delete\" backgroundColor=\"red\">清除服务器失效文件</lh-button>\r\n    <lh-dialog :visible.sync=\"visible\">\r\n      <div slot=\"title\">添加版本</div>\r\n      <table>\r\n        <tr>\r\n          <td>上传安装包</td>\r\n          <td>\r\n            <lh-button accept=\".apk\" @change=\"selectFile\">\r\n              选择apk文件\r\n            </lh-button>\r\n            <div v-if=\"apkFile\" style=\"font-size: 10px;color: red;\">\r\n              {{ apkFile.name }}\r\n            </div>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td>\r\n            设置版本号\r\n            <div v-if=\"maxVersion\" style=\"font-size: 10px;color: red;\">\r\n              *当前最大版本：{{maxVersion.versionString}}\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <lh-select v-model=\"version.versionString\">\r\n              <lh-option v-for=\"(item,index) of vList\" :value=\"item\" :key=\"index\">\r\n                {{ item }}\r\n              </lh-option>\r\n            </lh-select>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td>是否强制更新</td>\r\n          <td>\r\n            <lh-radio v-model=\"version.force\" :radioValue=\"true\">是</lh-radio>\r\n            <lh-radio v-model=\"version.force\" :radioValue=\"false\">否</lh-radio>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n      <div slot=\"footer\">\r\n        <lh-button @click=\"confirm\" :loading=\"loading\">确认</lh-button>\r\n      </div>\r\n    </lh-dialog>\r\n    <lh-dialog :visible.sync=\"eVisible\">\r\n      <div>\r\n        <span>是否强制更新：</span>\r\n        <lh-radio v-model=\"eVersion.force\" :radioValue=\"true\">是</lh-radio>\r\n        <lh-radio v-model=\"eVersion.force\" :radioValue=\"false\">否</lh-radio>\r\n      </div>\r\n      <lh-checkbox v-model=\"eVersion.update\">设置为最新版本</lh-checkbox>\r\n      <div slot=\"footer\">\r\n        <lh-button @click=\"save\" :loading=\"loading\">保存</lh-button>\r\n      </div>\r\n    </lh-dialog>\r\n    <lh-button v-if=\"maxVersion\" @click=\"visible=true\">添加新版本</lh-button>\r\n    <lh-table>\r\n      <lh-tr>\r\n        <lh-th>序号</lh-th>\r\n        <lh-th>版本号</lh-th>\r\n        <lh-th>更新时间</lh-th>\r\n        <lh-th>是否强制更新</lh-th>\r\n        <lh-th>操作</lh-th>\r\n      </lh-tr>\r\n      <lh-tr v-for=\"(item,index) of versionList\" :key=\"item.id\">\r\n        <lh-td>{{ index+1 }}</lh-td>\r\n        <lh-td>{{ item.versionString }}</lh-td>\r\n        <lh-td>\r\n          {{ item.updateTime }}\r\n          <div v-if=\"index==0\" style=\"color:red;font-size: 10px;\">*最新版本</div>\r\n        </lh-td>\r\n        <lh-td>\r\n          {{ item.force?\"是\":\"否\" }}\r\n        </lh-td>\r\n        <lh-td>\r\n          <!-- <lh-button @click=\"updateVersion\" :disabled=\"index==0\">\r\n            {{ index==0?'最新版本':\"设置为最新版本\" }}\r\n          </lh-button> -->\r\n          <lh-button @click=\"edit(index)\">编辑</lh-button>\r\n          <lh-button @click=\"deleteVersion(index)\" icon=\"lh-icon-delete\" backgroundColor=\"red\">\r\n            删除\r\n          </lh-button>\r\n        </lh-td>\r\n      </lh-tr>\r\n    </lh-table>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"../../utils/request\";\r\nimport {uploadFile,SaveUrl} from \"../../utils/file\";\r\nimport { formatDate } from \"../../utils/lhUtils\";\r\nexport default {\r\n  name:\"Favorites\",\r\n  data(){\r\n    return {\r\n      visible:false,\r\n      maxVersion:null,\r\n      versionList:null,\r\n      vList:null,\r\n      loading:false,\r\n      version:{\r\n        versionString:\"1.0.0\",\r\n        fileId:null,\r\n        force:false\r\n      },\r\n      eVisible:false,\r\n      eVersion:{\r\n        id:null,\r\n        force:false,\r\n        update:false,\r\n        updateTime:null\r\n      },\r\n      apkFile:null\r\n    }\r\n  },\r\n  mounted(){\r\n    this.getMaxVersion();\r\n    this.getVersionList();\r\n  },\r\n  methods:{\r\n    getMaxVersion:function(){\r\n      let that=this;\r\n      request.get(\"/version/getMaxVersion\").then((data)=>{\r\n        that.maxVersion=data;\r\n        let vList=[];\r\n        vList.push((data.partMap.p1+1)+\".\"+data.partMap.p2+\".\"+data.partMap.p3);\r\n        vList.push(data.partMap.p1+\".\"+(data.partMap.p2+1)+\".\"+data.partMap.p3);\r\n        vList.push(data.partMap.p1+\".\"+data.partMap.p2+\".\"+(data.partMap.p3+1));\r\n        that.vList=vList;\r\n        that.version.versionString=vList[0];\r\n      });\r\n    },\r\n    selectFile:function(e){\r\n      console.log(\"e\",e);\r\n      this.apkFile=e.target.files[0];\r\n    },\r\n    confirm:function(){\r\n      if(this.apkFile==null){\r\n        this.$lhMessage(\"warn\",\"请上传安装包\");\r\n        return;\r\n      }\r\n      let that=this;\r\n      this.loading=true;\r\n      uploadFile(this.apkFile,SaveUrl.APK,\"apk\").then((data)=>{\r\n        that.version.fileId=data.id;\r\n        request.post(\"/version/addVersion\",that.version).then((version)=>{\r\n          that.maxVersion=version;\r\n          that.visible=false;\r\n          that.$lhMessage(\"success\",\"上传成功\");\r\n          that.getVersionList();\r\n        }).finally(()=>{\r\n          that.loading=false;\r\n        });\r\n      }).finally(()=>{\r\n        that.loading=false;\r\n      })\r\n    },\r\n    clearFile:function(){\r\n      this.$lhLoading.open();\r\n      let that=this;\r\n      request.post(\"/file/deleteLostFile\").then(()=>{\r\n        that.$lhMessage(\"success\",\"清除成功\");\r\n      }).finally(()=>{\r\n        that.$lhLoading.close();\r\n      })\r\n    },\r\n    getVersionList:function(){\r\n      this.$lhLoading.open();\r\n      let that=this;\r\n      request.get(\"/version/getVersionList\").then((data)=>{\r\n        that.versionList=data;\r\n      }).finally(()=>{\r\n        that.$lhLoading.close()\r\n      })\r\n    },\r\n    updateVersion:function(id){\r\n      this.$lhLoading.open();\r\n      let that=this;\r\n      request.post(\"/version/updateVersionById\",{id:id}).then(()=>{\r\n        that.getVersionList();\r\n      }).finally(()=>{\r\n        that.$lhLoading.close();\r\n      })\r\n    },\r\n    deleteVersion:function(index){\r\n      let that=this;\r\n      this.$lhMessageBox(\"删除版本\",\"确认删除版本\"+this.versionList[index].versionString+\"？\").then(()=>{\r\n        that.$lhLoading.open();\r\n        request.post(\"/version/deleteVersionById\",{id:that.versionList[index].id},{\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }).then(()=>{\r\n          that.versionList.splice(index,1);\r\n          that.$lhMessage(\"success\",\"删除成功\");\r\n        }).finally(()=>{\r\n          that.$lhLoading.close();\r\n        });\r\n\t\t\t});\r\n    },\r\n    edit:function(index){\r\n      this.eVersion.id=this.versionList[index].id;\r\n      this.eVersion.force=this.versionList[index].force;\r\n      this.eVisible=true;\r\n    },\r\n    save:function(){\r\n      this.loading=true;\r\n      let that=this;\r\n      if(this.eVersion.update){\r\n        this.eVersion.updateTime=formatDate(new Date());\r\n      }else{\r\n        this.eVersion.updateTime=null;\r\n      }\r\n      request.post(\"/version/updateVersion\",this.eVersion).then(()=>{\r\n        that.getVersionList();\r\n        that.eVisible=false;\r\n        that.$lhMessage(\"success\",\"保存成功\");\r\n      }).finally(()=>{\r\n        that.loading=false;\r\n      });\r\n    }\r\n    \r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.favorites{\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=481433ae&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=481433ae&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"481433ae\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}